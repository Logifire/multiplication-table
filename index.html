<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplikationstabel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
            text-align: center;
            padding: 20px;
        }
        h1 {
            color: #333;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            margin: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        table {
            margin: 0 auto;
            border-collapse: collapse;
            width: 80%;
            max-width: 600px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
            font-size: 18px;
        }
        th {
            background-color: #f2f2f2;
        }
        .hidden {
            display: none;
        }
        .checkbox-cell {
            text-align: center;
        }
        .cell {
            transition: background-color 0.3s, transform 0.3s;
        }
        .cell.correct {
            background-color: #d4edda;
            transform: scale(1.1);
        }
        .cell.incorrect {
            background-color: #f8d7da;
            transform: scale(0.9);
        }
        .cell.solved {
            background-color: #d4edda;
        }
        #feedback {
            font-size: 18px;
            margin-top: 10px;
        }
        #question {
            font-size: 24px;
            font-weight: bold;
        }
        #answer {
            padding: 10px;
            font-size: 18px;
            width: 100px;
            margin: 10px;
        }
        #timer {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Multiplikationstabel 1-10</h1>
    <div id="timer">00:00.00</div>
    <button id="gameToggle" onclick="toggleGame()">Start Spillet</button>
    <button onclick="toggleCells()">Vis/Skjul Alle Felter</button>
    <table id="multiplicationTable">
        <thead>
            <tr>
                <th></th>
                <th>1</th>
                <th>2</th>
                <th>3</th>
                <th>4</th>
                <th>5</th>
                <th>6</th>
                <th>7</th>
                <th>8</th>
                <th>9</th>
                <th>10</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th><label><input type="checkbox" class="table-checkbox" value="1" checked> 1</label></th>
                <td class="cell" data-value="1">1</td>
                <td class="cell" data-value="2">2</td>
                <td class="cell" data-value="3">3</td>
                <td class="cell" data-value="4">4</td>
                <td class="cell" data-value="5">5</td>
                <td class="cell" data-value="6">6</td>
                <td class="cell" data-value="7">7</td>
                <td class="cell" data-value="8">8</td>
                <td class="cell" data-value="9">9</td>
                <td class="cell" data-value="10">10</td>
            </tr>
            <tr>
                <th><label><input type="checkbox" class="table-checkbox" value="2" checked> 2</label></th>
                <td class="cell" data-value="2">2</td>
                <td class="cell" data-value="4">4</td>
                <td class="cell" data-value="6">6</td>
                <td class="cell" data-value="8">8</td>
                <td class="cell" data-value="10">10</td>
                <td class="cell" data-value="12">12</td>
                <td class="cell" data-value="14">14</td>
                <td class="cell" data-value="16">16</td>
                <td class="cell" data-value="18">18</td>
                <td class="cell" data-value="20">20</td>
            </tr>
            <tr>
                <th><label><input type="checkbox" class="table-checkbox" value="3" checked> 3</label></th>
                <td class="cell" data-value="3">3</td>
                <td class="cell" data-value="6">6</td>
                <td class="cell" data-value="9">9</td>
                <td class="cell" data-value="12">12</td>
                <td class="cell" data-value="15">15</td>
                <td class="cell" data-value="18">18</td>
                <td class="cell" data-value="21">21</td>
                <td class="cell" data-value="24">24</td>
                <td class="cell" data-value="27">27</td>
                <td class="cell" data-value="30">30</td>
            </tr>
            <tr>
                <th><label><input type="checkbox" class="table-checkbox" value="4" checked> 4</label></th>
                <td class="cell" data-value="4">4</td>
                <td class="cell" data-value="8">8</td>
                <td class="cell" data-value="12">12</td>
                <td class="cell" data-value="16">16</td>
                <td class="cell" data-value="20">20</td>
                <td class="cell" data-value="24">24</td>
                <td class="cell" data-value="28">28</td>
                <td class="cell" data-value="32">32</td>
                <td class="cell" data-value="36">36</td>
                <td class="cell" data-value="40">40</td>
            </tr>
            <tr>
                <th><label><input type="checkbox" class="table-checkbox" value="5" checked> 5</label></th>
                <td class="cell" data-value="5">5</td>
                <td class="cell" data-value="10">10</td>
                <td class="cell" data-value="15">15</td>
                <td class="cell" data-value="20">20</td>
                <td class="cell" data-value="25">25</td>
                <td class="cell" data-value="30">30</td>
                <td class="cell" data-value="35">35</td>
                <td class="cell" data-value="40">40</td>
                <td class="cell" data-value="45">45</td>
                <td class="cell" data-value="50">50</td>
            </tr>
            <tr>
                <th><label><input type="checkbox" class="table-checkbox" value="6" checked> 6</label></th>
                <td class="cell" data-value="6">6</td>
                <td class="cell" data-value="12">12</td>
                <td class="cell" data-value="18">18</td>
                <td class="cell" data-value="24">24</td>
                <td class="cell" data-value="30">30</td>
                <td class="cell" data-value="36">36</td>
                <td class="cell" data-value="42">42</td>
                <td class="cell" data-value="48">48</td>
                <td class="cell" data-value="54">54</td>
                <td class="cell" data-value="60">60</td>
            </tr>
            <tr>
                <th><label><input type="checkbox" class="table-checkbox" value="7" checked> 7</label></th>
                <td class="cell" data-value="7">7</td>
                <td class="cell" data-value="14">14</td>
                <td class="cell" data-value="21">21</td>
                <td class="cell" data-value="28">28</td>
                <td class="cell" data-value="35">35</td>
                <td class="cell" data-value="42">42</td>
                <td class="cell" data-value="49">49</td>
                <td class="cell" data-value="56">56</td>
                <td class="cell" data-value="63">63</td>
                <td class="cell" data-value="70">70</td>
            </tr>
            <tr>
                <th><label><input type="checkbox" class="table-checkbox" value="8" checked> 8</label></th>
                <td class="cell" data-value="8">8</td>
                <td class="cell" data-value="16">16</td>
                <td class="cell" data-value="24">24</td>
                <td class="cell" data-value="32">32</td>
                <td class="cell" data-value="40">40</td>
                <td class="cell" data-value="48">48</td>
                <td class="cell" data-value="56">56</td>
                <td class="cell" data-value="64">64</td>
                <td class="cell" data-value="72">72</td>
                <td class="cell" data-value="80">80</td>
            </tr>
            <tr>
                <th><label><input type="checkbox" class="table-checkbox" value="9" checked> 9</label></th>
                <td class="cell" data-value="9">9</td>
                <td class="cell" data-value="18">18</td>
                <td class="cell" data-value="27">27</td>
                <td class="cell" data-value="36">36</td>
                <td class="cell" data-value="45">45</td>
                <td class="cell" data-value="54">54</td>
                <td class="cell" data-value="63">63</td>
                <td class="cell" data-value="72">72</td>
                <td class="cell" data-value="81">81</td>
                <td class="cell" data-value="90">90</td>
            </tr>
            <tr>
                <th><label><input type="checkbox" class="table-checkbox" value="10" checked> 10</label></th>
                <td class="cell" data-value="10">10</td>
                <td class="cell" data-value="20">20</td>
                <td class="cell" data-value="30">30</td>
                <td class="cell" data-value="40">40</td>
                <td class="cell" data-value="50">50</td>
                <td class="cell" data-value="60">60</td>
                <td class="cell" data-value="70">70</td>
                <td class="cell" data-value="80">80</td>
                <td class="cell" data-value="90">90</td>
                <td class="cell" data-value="100">100</td>
            </tr>
            <tr id="gameRow" class="hidden">
                <th></th>
                <td colspan="10">
                    <span id="question"></span>
                    <input type="number" id="answer" placeholder="Indtast dit svar" onkeydown="handleKeyDown(event)">
                    <button onclick="checkAnswer()">Tjek svar</button>
                    <p id="feedback"></p>
                </td>
            </tr>
        </tbody>
    </table>
    <script>
        let currentQuestion = {};
        let cellsVisible = false;
        let timerInterval;
        let startTime;
        let gameActive = false;

        function toggleGame() {
            if (gameActive) {
                stopGame();
                document.getElementById('gameToggle').textContent = 'Start Spillet';
            } else {
                startGame();
                document.getElementById('gameToggle').textContent = 'Stop Spillet';
            }
        }

        function startGame() {
            if (gameActive) return;
            gameActive = true;
            startTime = Date.now();
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(updateTimer, 10);
            
            const cells = document.querySelectorAll('.cell');
            cells.forEach(cell => {
                cell.textContent = '?';
                cell.classList.remove('solved', 'correct', 'incorrect');
                cell.classList.remove('hidden');
            });
            document.getElementById('gameRow').classList.remove('hidden');
            document.getElementById('answer').disabled = false;
            document.getElementById('feedback').textContent = '';
            generateQuestion();
        }

        function stopGame() {
            if (!gameActive) return;
            gameActive = false;
            clearInterval(timerInterval);
            
            const cells = document.querySelectorAll('.cell');
            cells.forEach(cell => {
                cell.textContent = cell.getAttribute('data-value');
                cell.classList.remove('solved', 'correct', 'incorrect');
            });
            
            document.getElementById('gameRow').classList.add('hidden');
            document.getElementById('question').textContent = '';
            document.getElementById('answer').value = '';
            document.getElementById('answer').disabled = true;
            document.getElementById('feedback').textContent = 'Spillet er stoppet';
        }

        function updateTimer() {
            const elapsed = Date.now() - startTime;
            const minutes = Math.floor(elapsed / 60000);
            const seconds = Math.floor((elapsed % 60000) / 1000);
            const milliseconds = Math.floor((elapsed % 1000) / 10); // Get 2 digits of milliseconds
            document.getElementById('timer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}.${milliseconds.toString().padStart(2, '0')}`;
        }

        function toggleCells() {
            const cells = document.querySelectorAll('.cell');
            cellsVisible = !cellsVisible;
            cells.forEach(cell => {
                if (!cell.classList.contains('solved')) {
                    cell.textContent = cellsVisible ? cell.getAttribute('data-value') : '?';
                }
            });
        }

        function generateQuestion() {
            if (!gameActive) return;
            const selectedValues = Array.from(document.querySelectorAll('.table-checkbox:checked')).map(cb => parseInt(cb.value, 10));
            const unsolvedCells = [];
            
            selectedValues.forEach(num1 => {
                for (let col = 1; col <= 10; col++) {
                    const cell = document.querySelector(`#multiplicationTable tbody tr:nth-child(${num1}) td:nth-child(${col + 1})`);
                    if (cell && !cell.classList.contains('solved')) {
                        unsolvedCells.push({ 
                            row: num1,     // Rækken er den valgte talrække
                            col: col + 1,  // Kolonnen (+1 for at kompensere for th)
                            num1: col,     // Første faktor (fra kolonnen)
                            num2: num1     // Anden faktor (fra rækken)
                        });
                    }
                }
            });

            if (unsolvedCells.length === 0) {
                const finalTime = document.getElementById('timer').textContent;
                document.getElementById('feedback').textContent = `Alle opgaver er løst! Din tid: ${finalTime}`;
                document.getElementById('question').textContent = '';
                document.getElementById('answer').disabled = true;
                clearInterval(timerInterval); // Stop timer when finished
                return;
            }

            const randomIndex = Math.floor(Math.random() * unsolvedCells.length);
            currentQuestion = unsolvedCells[randomIndex];
            currentQuestion.answer = currentQuestion.num1 * currentQuestion.num2;
            document.getElementById('question').textContent = `${currentQuestion.num1} x ${currentQuestion.num2} = `;
            document.getElementById('answer').value = '';
            document.getElementById('answer').disabled = false;
            document.getElementById('feedback').textContent = '';
            document.getElementById('answer').focus();
        }

        function checkAnswer() {
            if (!gameActive) return;
            const userAnswer = parseInt(document.getElementById('answer').value, 10);
            const cell = document.querySelector(`#multiplicationTable tbody tr:nth-child(${currentQuestion.row}) td:nth-child(${currentQuestion.col})`);
            if (userAnswer === currentQuestion.answer) {
                cell.textContent = currentQuestion.answer;
                cell.classList.add('correct', 'solved');
                generateQuestion();
            } else {
                cell.classList.add('incorrect');
                setTimeout(() => cell.classList.remove('incorrect'), 500);
                document.getElementById('answer').select();
            }
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter') {
                checkAnswer();
            }
        }
    </script>
</body>
</html>